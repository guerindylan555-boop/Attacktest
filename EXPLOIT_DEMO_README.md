# MaynDrive Security Exploitation Demo - Quick Start Guide

## ğŸš¨ WARNING: AUTHORIZED TESTING ONLY

This tool demonstrates **real attack vectors** against the MaynDrive API. Only use on systems you own or have explicit written permission to test. Unauthorized security testing is illegal.

---

## ğŸ¯ What This Tool Does

This interactive web application demonstrates how attackers could exploit vulnerabilities in the MaynDrive API to gain unauthorized admin access. It includes:

1. **Scope Escalation Attack** - Request admin privileges during login
2. **JWT Token Manipulation** - Tamper with authentication tokens
3. **Admin Endpoint Enumeration** - Access admin endpoints with user tokens
4. **Mass Vehicle Unlock** - Demonstrate fleet-wide compromise
5. **Device Spoofing** - Bypass device-based security controls

---

## ğŸ“‹ Prerequisites

```bash
# Required
pip install flask requests

# Optional (for JWT manipulation test)
pip install pyjwt
```

---

## ğŸš€ Quick Start

### Step 1: Install Dependencies

```bash
pip install flask requests pyjwt
```

### Step 2: Launch the Web App

```bash
python exploit_demo_webapp.py
```

You should see:

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   MaynDrive Security Exploitation Demo                   â•‘
â•‘                                                            â•‘
â•‘   âš ï¸  WARNING: FOR AUTHORIZED TESTING ONLY!               â•‘
â•‘                                                            â•‘
â•‘   This tool demonstrates real attack vectors.            â•‘
â•‘   Only use on systems you own or have permission to test.â•‘
â•‘                                                            â•‘
â•‘   Running at: http://localhost:5000                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

 * Running on http://0.0.0.0:5000
```

### Step 3: Open in Browser

Navigate to: **http://localhost:5000**

### Step 4: Enter Test Credentials

Enter your MaynDrive account credentials:
- **Email**: Your test account email
- **Password**: Your test account password

âš ï¸ **IMPORTANT**: Use a **test account** in a **test environment**. Never use production credentials!

### Step 5: Run Exploits

Click on any exploit card to test that specific vulnerability, or click **"Execute All Exploits"** to run the complete test suite.

---

## ğŸ“Š Understanding Results

### ğŸš¨ VULNERABLE Results

If an exploit shows **VULNERABLE**:
- âœ… The exploit works - system has this vulnerability
- âŒ **ACTION REQUIRED**: Review `SECURITY_ANALYSIS.md` for fixes
- ğŸ”´ **CRITICAL**: Fix immediately if marked as critical severity

### âœ… SECURE Results

If an exploit shows **SECURE**:
- âœ… System is protected against this attack
- âœ… Proper authorization/validation is in place
- ğŸŸ¢ No action needed for this vulnerability

### â“ UNCLEAR Results

If results are unclear:
- May need manual inspection
- Check the detailed JSON response
- Review server logs

---

## ğŸ­ Detailed Exploit Descriptions

### 1ï¸âƒ£ Scope Escalation Attack

**What it tests:**
- Can regular users request "admin" scope during login?
- Does the backend trust client-provided role parameters?

**How it works:**
```python
# Attacker modifies login request
api.login(email, password, scope="admin")  # âš ï¸ Client-controlled!
```

**If vulnerable:**
- Any user can become admin by changing one parameter
- **Impact**: Complete fleet control

**Fix:**
- Remove `scope` parameter from login endpoint
- Determine roles SERVER-SIDE from database

---

### 2ï¸âƒ£ JWT Token Manipulation

**What it tests:**
- Can JWT tokens be tampered with?
- Does the backend properly validate token signatures?

**How it works:**
```python
# Attacker decodes token
payload = jwt.decode(token, verify_signature=False)

# Attacker modifies role/scope
payload['scope'] = 'admin'

# Attacker re-signs with weak key
fake_token = jwt.encode(payload, 'weak_key', algorithm='HS256')
```

**If vulnerable:**
- Attackers can forge admin tokens
- **Impact**: Bypass authentication entirely

**Fix:**
- Use RS256 (asymmetric) instead of HS256
- Always validate signature on backend
- Use strong, random secret keys

---

### 3ï¸âƒ£ Admin Endpoint Enumeration

**What it tests:**
- Can admin endpoints be accessed with user tokens?
- Are authorization checks actually implemented?

**How it works:**
```python
# Login as regular user
api.login(email, password, scope="user")

# Try to access admin endpoints
api.unlock_vehicle_admin(serial, lat, lng)  # Should fail!
```

**If vulnerable:**
- Admin endpoints only check token validity, not role
- **Impact**: Unauthorized admin operations

**Fix:**
- Add role-based authorization checks to EVERY admin endpoint
- Verify user permissions against database

---

### 4ï¸âƒ£ Mass Vehicle Unlock

**What it tests:**
- Can attacker unlock multiple vehicles rapidly?
- Is there rate limiting on admin operations?

**How it works:**
```python
# If attacker gains admin access
for vehicle in fleet:
    api.unlock_vehicle_admin(vehicle, lat, lng, force=True)
```

**If vulnerable:**
- No rate limiting on destructive operations
- **Impact**: Fleet-wide disruption

**Fix:**
- Implement rate limiting per user/endpoint
- Add alerting for suspicious bulk operations
- Require additional authentication for mass actions

---

### 5ï¸âƒ£ Device Spoofing

**What it tests:**
- Does backend validate device information?
- Can attackers use fake device IDs?

**How it works:**
```python
fake_device = {
    "uuid": "00000000-0000-0000-0000-000000000000",
    "platform": "attacker_os",
    "manufacturer": "HACKER"
}
api.login(email, password, device=fake_device)
```

**If vulnerable:**
- Device-based security controls can be bypassed
- **Impact**: Account sharing, easier token theft

**Fix:**
- Implement device registration/approval
- Limit active devices per account
- Detect and block suspicious device patterns

---

## ğŸ“ˆ Interpreting the Results

### Critical Severity (ğŸ”´)
- **Immediate action required**
- Can lead to complete system compromise
- Fix within 24-48 hours

### High Severity (ğŸŸ )
- **Action needed soon**
- Significant security risk
- Fix within 1-2 weeks

### Medium Severity (ğŸŸ¡)
- **Should be addressed**
- Moderate risk
- Fix within 1 month

---

## ğŸ” What To Do If Vulnerable

### 1. **Document Findings**
- Save the JSON report: `security_test_report.json`
- Take screenshots of vulnerable results
- Note which exploits succeeded

### 2. **Review Security Analysis**
- Read `SECURITY_ANALYSIS.md` for detailed remediation steps
- Prioritize fixes by severity level

### 3. **Implement Fixes**
- Start with critical vulnerabilities
- Test fixes in staging environment first
- Re-run exploits to verify fixes

### 4. **Security Review**
- Conduct code review of authentication/authorization
- Review all admin endpoints
- Implement comprehensive logging

### 5. **Ongoing Security**
- Regular security testing
- Monitor for suspicious admin activity
- Keep security documentation updated

---

## ğŸ› ï¸ Advanced Usage

### Running Specific Exploits via API

```bash
# Scope Escalation
curl -X POST http://localhost:5000/api/exploit/scope-escalation \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'

# Token Manipulation
curl -X POST http://localhost:5000/api/exploit/token-manipulation \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'

# Endpoint Enumeration
curl -X POST http://localhost:5000/api/exploit/endpoint-enumeration \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'
```

### Viewing Exploitation Log

```bash
curl http://localhost:5000/api/exploitation-log
```

### Automated Testing Script

```python
import requests

base_url = "http://localhost:5000"
creds = {"email": "test@example.com", "password": "password123"}

exploits = [
    "scope-escalation",
    "token-manipulation",
    "endpoint-enumeration",
    "mass-unlock",
    "device-spoofing"
]

for exploit in exploits:
    response = requests.post(f"{base_url}/api/exploit/{exploit}", json=creds)
    result = response.json()
    print(f"{exploit}: {'VULNERABLE' if result.get('vulnerable') else 'SECURE'}")
```

---

## ğŸ“ Sample Output

### Vulnerable System:

```
COMPLETE SECURITY ASSESSMENT
============================
Total Tests: 5
Vulnerabilities Found: 4
Secure: 1

ğŸš¨ SCOPE ESCALATION - VULNERABLE
   Regular user successfully gained admin access

ğŸš¨ TOKEN MANIPULATION - VULNERABLE
   JWT tokens can be tampered with weak key

ğŸš¨ ENDPOINT ENUMERATION - VULNERABLE
   3 admin endpoints accessible with user token

ğŸš¨ MASS UNLOCK - VULNERABLE
   Successfully unlocked 8 test vehicles

âœ… DEVICE SPOOFING - SECURE
   Fake device information was rejected
```

### Secure System:

```
COMPLETE SECURITY ASSESSMENT
============================
Total Tests: 5
Vulnerabilities Found: 0
Secure: 5

âœ… All exploits properly defended!
   System has strong authorization controls
```

---

## ğŸš« Common Issues

### Issue: "Login failed"
**Solution**: Verify credentials are correct. Try logging in through the actual app first.

### Issue: "Connection refused"
**Solution**: Ensure the webapp is running (`python exploit_demo_webapp.py`)

### Issue: "ModuleNotFoundError: No module named 'flask'"
**Solution**: Install dependencies: `pip install flask requests pyjwt`

### Issue: "All tests show unclear results"
**Solution**: The API may have changed. Review actual API responses in the JSON output.

---

## ğŸ“š Additional Resources

- **Security Analysis**: `SECURITY_ANALYSIS.md` - Detailed vulnerability descriptions
- **API Client**: `mayn_drive_api.py` - Python API client library
- **Test Suite**: `test_security_vulnerabilities.py` - Command-line testing tool

---

## âš–ï¸ Legal Disclaimer

This tool is provided for **educational and authorized security testing purposes only**.

By using this tool, you agree that:
- âœ… You have explicit written permission to test the target system
- âœ… You will only use this on your own systems or authorized test environments
- âœ… You understand unauthorized security testing may be illegal
- âœ… You accept full responsibility for your actions
- âœ… The authors are not liable for misuse of this tool

**Always obtain proper authorization before security testing!**

---

## ğŸ¤ Contributing

Found a new vulnerability? Want to add more exploits?

1. Document the vulnerability
2. Create a proof-of-concept exploit
3. Add it to the web app
4. Update this documentation

---

## ğŸ“ Support

For questions about this tool:
1. Review the security analysis document
2. Check the API client documentation
3. Examine the source code for implementation details

---

**ğŸ”’ Remember: With great power comes great responsibility. Use these tools ethically!**

